<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Component advanced techniques | kivi</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../advanced/04_virtual_dom.html" />
    
    
    <link rel="prev" href="../advanced/02_scheduler.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="3.3"
        data-chapter-title="Component advanced techniques"
        data-filepath="advanced/03_components.md"
        data-basepath=".."
        data-revision="Thu May 12 2016 09:30:06 GMT+0600 (NOVT)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="01_getting_started.html">
            
                
                    <a href="../01_getting_started.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Getting Started
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" >
            
            <span><b>2.</b> Basics</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="basics/01_components.html">
            
                
                    <a href="../basics/01_components.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Components
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="basics/02_virtual_dom.html">
            
                
                    <a href="../basics/02_virtual_dom.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Virtual DOM
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" >
            
            <span><b>3.</b> Advanced</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="advanced/01_vmodel.html">
            
                
                    <a href="../advanced/01_vmodel.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        VModel
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="advanced/02_scheduler.html">
            
                
                    <a href="../advanced/02_scheduler.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Scheduler
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="3.3" data-path="advanced/03_components.html">
            
                
                    <a href="../advanced/03_components.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Component advanced techniques
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="advanced/04_virtual_dom.html">
            
                
                    <a href="../advanced/04_virtual_dom.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        Virtual DOM advanced techniques
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="advanced/05_container_manager.html">
            
                
                    <a href="../advanced/05_container_manager.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        Container Manager
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >kivi</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="component-advanced-techniques">Component advanced techniques</h1>
<h2 id="component-recycling">Component recycling</h2>
<p>When there are many instances of a component and they are quite frequently removed and inserted into documented, it is
a good practice to enable recycling, so instead of disposing component instances when they are removed from the
document, they will be placed into recycled pool, and when component instance is created it will always check if
recycled pool has any available instance and just reuse it.</p>
<p>Component descriptor method <code>enableComponentRecycling(maxRecycled: number)</code> will enable recycling for component,
<code>maxRecycled</code> parameter controls the size of recycled pool for this component type.</p>
<pre><code class="lang-ts"><span class="hljs-keyword">const</span> Button = <span class="hljs-keyword">new</span> ComponentDescriptor()
  .enableComponentRecycling(<span class="hljs-number">100</span>)
  .vRender((c, root) =&gt; { root.className(<span class="hljs-string">&quot;button&quot;</span>); });
</code></pre>
<p>Note: kivi library should be compiled with enabled component recycling. To enable recycling, replace all string
occurences <code>&lt;@KIVI_COMPONENT_RECYCLING@&gt;</code> with <code>COMPONENT_RECYCLING_ENABLED</code>.</p>
<h2 id="animated-components">Animated components</h2>
<p>To update components on each frame, just add them to the list of components that should be updated on each frame with
method <code>startUpdateEachFrame()</code>. For example:</p>
<pre><code class="lang-ts"><span class="hljs-keyword">const</span> AnimatedComponent = <span class="hljs-keyword">new</span> ComponentDescriptor()
  .init((c) =&gt; {
    c.startUpdateEachFrame();
  })
  .update((c) =&gt; {
    c.element.style.color = `rgba(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, ${<span class="hljs-built_in">Math</span>.random()})`;
  });
</code></pre>
<p><code>stopUpdateEachFrame()</code> method will remove component from the list of components that should be updated on each frame.</p>
<h2 id="shallow-update">Shallow update</h2>
<p>Shallow updates will perform updates on a subtree of nodes without binding new props and triggering updates for
subcomponents.</p>
<pre><code class="lang-ts"><span class="hljs-keyword">const</span> MyComponent = <span class="hljs-keyword">new</span> ComponentDescriptor()
  .update((c) =&gt; {
    c.advancedVSync(RenderFlags.ShallowUpdate, c.createVRoot().children([
      ChildComponent.createVRoot(),
      ChildComponent.createVRoot(),
    ]));
  });
</code></pre>
<p><code>RenderFlags</code> also has a flag for shallow rendering <code>ShallowRender</code> that prevents from rendering subcomponents when they
are created for the first time.</p>
<h2 id="incremental-rendering-experimental">Incremental rendering **EXPERIMENTAL**</h2>
<p>Components provide two methods that can trigger incremental rendering: <code>startInteraction()</code> and <code>stopInteraction()</code>.</p>
<p><code>startInteraction()</code> will enable throttling mode in the scheduler, increment its dependency counter, and mark component
as a high priority component. High priority components will be updated even if timeframe for a throttled frame is over.</p>
<p><code>finishInteraction()</code> will decrease throttling mode dependency counter, and when this counter gets to zero, it will
disable throttling mode. It also removes flag indicating that component should be a high priority for updates.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../advanced/02_scheduler.html" class="navigation navigation-prev " aria-label="Previous page: Scheduler"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../advanced/04_virtual_dom.html" class="navigation navigation-next " aria-label="Next page: Virtual DOM advanced techniques"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-edit-link/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-github/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-anker-enable/anker.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"edit-link":{"base":"https://github.com/localvoid/kivi/tree/master/docs","label":"Edit This Page"},"github":{"url":"https://github.com/localvoid/kivi/"},"anker-enable":{},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"all":["facebook","google","twitter","weibo","instapaper"],"facebook":true,"google":false,"instapaper":false,"twitter":true,"vk":false,"weibo":false},"fontsettings":{"family":"sans","size":2,"theme":"white"}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
